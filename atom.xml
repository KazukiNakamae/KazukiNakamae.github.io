<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>n|nja</title>
  
  <subtitle>Bioinfomatics &amp; Genome editing</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://KazukiNakamae.github.io/"/>
  <updated>2019-12-15T10:14:07.730Z</updated>
  <id>https://KazukiNakamae.github.io/</id>
  
  <author>
    <name>Kazuki Nakamae</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>How to obtain gene information of hg19 from NCBI</title>
    <link href="https://KazukiNakamae.github.io/2019/12/15/how-to-obtain-gene-information-of-hg19-from-NCBI/"/>
    <id>https://KazukiNakamae.github.io/2019/12/15/how-to-obtain-gene-information-of-hg19-from-NCBI/</id>
    <published>2019-12-15T09:41:15.000Z</published>
    <updated>2019-12-15T10:14:07.730Z</updated>
    
    <content type="html"><![CDATA[<p>Hi sir,<br>I am Kazuki Nakamae from Japan.</p><p>In genome analysis, software sometimes requires gene information of hg19. What is hg19? You can see the explain in <a href="https://www.biostars.org/p/17107/" title="Bioster" target="_blank" rel="noopener">the link</a></p><p>I introcuce how to obtain a gene infromation of hg19 using NCBI database.<br>Please watch the following video.</p><div class="video-container"><iframe src="//www.youtube.com/embed/v=2_IvhTYNFLY" frameborder="0" allowfullscreen></iframe></div><p>In this video, I obtained the Human VEGFA information of hg19. I chose “GRCh37.p13 Primary Assembly” at 1:00 of the video. It is important because GRCh37.p13 Primary Assembly is almost equal to hg19. You can see <a href="https://www.biostars.org/p/123767/" title="Bioster" target="_blank" rel="noopener">the link</a>.</p><p>Thank you so much…</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;Hi sir,&lt;br&gt;I am Kazuki Nakamae from Japan.&lt;/p&gt;
&lt;p&gt;In genome analysis, software sometimes requires gene information of hg19. What is hg19?
      
    
    </summary>
    
    
      <category term="Basic bioinformatics" scheme="https://KazukiNakamae.github.io/categories/Basic-bioinformatics/"/>
    
    
      <category term="Bioinformatics" scheme="https://KazukiNakamae.github.io/tags/Bioinformatics/"/>
    
      <category term="NCBI" scheme="https://KazukiNakamae.github.io/tags/NCBI/"/>
    
  </entry>
  
  <entry>
    <title>How to find sgRNA target sequences using CRISPRdirect</title>
    <link href="https://KazukiNakamae.github.io/2019/11/16/how-to-find-sgRNA-target-sequences-using-CRISPRdirect/"/>
    <id>https://KazukiNakamae.github.io/2019/11/16/how-to-find-sgRNA-target-sequences-using-CRISPRdirect/</id>
    <published>2019-11-16T07:20:50.000Z</published>
    <updated>2019-12-15T09:45:35.942Z</updated>
    
    <content type="html"><![CDATA[<p>Hi sir,<br>How is the weekend?</p><p>Today, I introduce <a href="https://crispr.dbcls.jp" title="CRISPRdirect" target="_blank" rel="noopener">CRISPRdirect</a> which is a quite fast search tool of sgRNA. Now, CRISPRdirect supports many (&gt;200) species. If you design sgRNA targeting the genome of organisms that are not a model organism, this tool would be helpful.</p><p>Citation info: <a href="https://academic.oup.com/bioinformatics/article/31/7/1120/180346" title="CRISPRdirect" target="_blank" rel="noopener">Naito, Yuki, et al. “CRISPRdirect: software for designing CRISPR/Cas guide RNA with reduced off-target sites.” Bioinformatics 31.7 (2014): 1120-1123.</a>.</p><p>An introduction video of CRISPRdirect has been uploaded by <a href="https://dbcls.rois.ac.jp/index.html" title="DBCLS" target="_blank" rel="noopener">the author group</a> on YouTude . Please check it.<br><a href="https://www.youtube.com/watch?v=OGdBU29v3jY" title="the introduction video" target="_blank" rel="noopener">“CRISPRdirect: designing CRISPR/Cas guide RNA sequence” on YouTude</a></p><p>You can see <a href="https://gggenome.dbcls.jp" title="GGGenome" target="_blank" rel="noopener">GGGenome</a> also. This is a very fast DNA search tool in the &gt;200 species as well as CRISPRdirect. This system shows the specificity of the target sequence including mismatch sequences. In my opinion, this is useful for designing primers.</p><p>The introduction video by <a href="https://dbcls.rois.ac.jp/index.html" title="DBCLS" target="_blank" rel="noopener">the author group</a><br><a href="https://www.youtube.com/watch?v=IZgGA94ooic" title="GGGenome: a fast and simple DNA sequence search engine" target="_blank" rel="noopener">“GGGenome: a fast and simple DNA sequence search engine” on YouTude</a></p><p>Thank you so much…</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;Hi sir,&lt;br&gt;How is the weekend?&lt;/p&gt;
&lt;p&gt;Today, I introduce &lt;a href=&quot;https://crispr.dbcls.jp&quot; title=&quot;CRISPRdirect&quot; target=&quot;_blank&quot; rel=&quot;noop
      
    
    </summary>
    
    
      <category term="sgRNA design" scheme="https://KazukiNakamae.github.io/categories/sgRNA-design/"/>
    
    
      <category term="Bioinformatics" scheme="https://KazukiNakamae.github.io/tags/Bioinformatics/"/>
    
      <category term="CRISPRdirect" scheme="https://KazukiNakamae.github.io/tags/CRISPRdirect/"/>
    
      <category term="GGGenome" scheme="https://KazukiNakamae.github.io/tags/GGGenome/"/>
    
  </entry>
  
  <entry>
    <title>How to find sgRNA target sequences using CHOPCHOP</title>
    <link href="https://KazukiNakamae.github.io/2019/11/15/how-to-find-sgRNA-target-sequences-using-CHOPCHOP/"/>
    <id>https://KazukiNakamae.github.io/2019/11/15/how-to-find-sgRNA-target-sequences-using-CHOPCHOP/</id>
    <published>2019-11-14T15:02:11.000Z</published>
    <updated>2019-12-15T09:45:29.295Z</updated>
    
    <content type="html"><![CDATA[<p>Hi sir,<br>I am fine.</p><p>Today, I introduce <a href="http://www.rgenome.net/cas-analyzer/#!" title="CHOPCHOP" target="_blank" rel="noopener">CHOPCHOP</a> which is web-based search tool of CRISPR–Cas single guide RNA (sgRNA) targets.</p><p>Citation info: <a href="https://academic.oup.com/nar/article/47/W1/W171/5491735" title="CHOPCHOP v3" target="_blank" rel="noopener">Labun, Kornel, et al. “CHOPCHOP v3: expanding the CRISPR web toolbox beyond genome editing.” Nucleic acids research (2019).</a>.</p><p>Thanks to many updates and author’s efforts, CHOPCHOP accommodates various sgRNA designs such as knock-out, knock-down, and knock-in…<br>In this post, I put a simple example. Please watch the following video.</p><div class="video-container"><iframe src="//www.youtube.com/embed/eYki1kf_mOQ" frameborder="0" allowfullscreen></iframe></div><p>I strongly recommend choosing the specific target where MM(MisMatch)0 is 0. And also, you can choose the target with MM1=0, MM2=0, and MM3=0 as long as you can.<br>CHOPCHOP can offer primer set for further analysis by deep sequencing or a T7E1 assay, and it can predict indel frequency based on <a href="https://www.nature.com/articles/s41586-018-0686-x" title="Shen et al. 2018" target="_blank" rel="noopener">Shen et al. 2018</a>. It would be helpful for your experiment.</p><p>Thank you so much…</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;Hi sir,&lt;br&gt;I am fine.&lt;/p&gt;
&lt;p&gt;Today, I introduce &lt;a href=&quot;http://www.rgenome.net/cas-analyzer/#!&quot; title=&quot;CHOPCHOP&quot; target=&quot;_blank&quot; rel=&quot;no
      
    
    </summary>
    
    
      <category term="sgRNA design" scheme="https://KazukiNakamae.github.io/categories/sgRNA-design/"/>
    
    
      <category term="Bioinformatics" scheme="https://KazukiNakamae.github.io/tags/Bioinformatics/"/>
    
      <category term="CHOPCHOP" scheme="https://KazukiNakamae.github.io/tags/CHOPCHOP/"/>
    
  </entry>
  
  <entry>
    <title>How to analyze CRISPR-Cas9 sample using CRISPResso in Anaconda environment</title>
    <link href="https://KazukiNakamae.github.io/2019/11/11/how-to-analize-CRISPR-Cas9-sample-CRISPResso/"/>
    <id>https://KazukiNakamae.github.io/2019/11/11/how-to-analize-CRISPR-Cas9-sample-CRISPResso/</id>
    <published>2019-11-11T14:05:41.000Z</published>
    <updated>2019-12-15T09:45:14.666Z</updated>
    
    <content type="html"><![CDATA[<p>Hi sir,<br>I feel like eating <a href="https://en.wikipedia.org/wiki/Citrus_unshiu" title="satsuma" target="_blank" rel="noopener">satsuma</a> due to Japanese cool climate. What is traditional winter fruit in your living place?</p><p>Anyway, today, I introduce how to analyze the CRISPR-Cas9 sample using <a href="http://github.com/lucapinello/CRISPResso" title="CRISPResso" target="_blank" rel="noopener">CRISPResso</a>. which is a user-friendly NGS analysis tool. This is specialized for analyzing genome editing data generated with CRISPR.</p><p>Citation info: <a href="https://www.nature.com/articles/nbt.3583" title="CRISPResso" target="_blank" rel="noopener">Pinello, Luca, et al. “Analyzing CRISPR genome-editing experiments with CRISPResso.” Nature biotechnology 34.7 (2016): 695.</a>.</p><p>I have to note that this is an old version of CRISPResso. <em>The author does not recommend to use it.</em> However, it has been used in several papers for a few years. It can be used to reproduce the data and perform the comparison.</p><p>I use the published raw NGS amplicon data (DRR147084_1.fastq.gz / DRR147084_2.fastq.gz) which was downloaded in step 4 of <a href="https://kazukinakamae.github.io/2019/10/27/How-to-map-NGS-data-using-BWAMEM/" title="How to map NGS data using BWA-MEM">the post</a> If you want to use the data, please check it.<br>This example NGS data (DRR147084) is amplicon sequencing data generated with MiSeq. The sample is a 77bp fragment MMEJ-assisted knock-in sample, which contains wildtype amplicon sequence reads, indel amplicon sequence reads, unexpected knock-in sequence reads (may be generated by NHEJ), and expected knock-in amplicon sequence reads generated by MMEJ.<br>Here are sequnece maps.</p><p><img src="/images/2019-11-14_1.png" alt="Wildtype amplicon sequence" title="Wildtype amplicon sequence"><br><img src="/images/2019-11-14_2.png" alt="Zoom image of Wildtype amplicon sequence" title="Zoom image of Wildtype amplicon sequence"><br><img src="/images/2019-11-14_3.png" alt="Expected knock-in amplicon sequence" title="Expected knock-in amplicon sequence"></p><p>I will show the example using it.</p><h3 id="STEP1-Searching-the-region-of-“focusing-range”-using-Blat"><a href="#STEP1-Searching-the-region-of-“focusing-range”-using-Blat" class="headerlink" title="STEP1: Searching the region of “focusing_range” using Blat"></a>STEP1: Searching the region of “focusing_range” using Blat</h3><h4 id="1-Create-visual-environment"><a href="#1-Create-visual-environment" class="headerlink" title="1: Create visual environment"></a>1: Create visual environment</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda create --name crispresso_env --channel bioconda crispresso;</span><br></pre></td></tr></table></figure><h4 id="2-Activate-visual-environment"><a href="#2-Activate-visual-environment" class="headerlink" title="2: Activate visual environment"></a>2: Activate visual environment</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">source</span> activate crispresso_env;</span><br></pre></td></tr></table></figure><h4 id="3-Run-CRSIPResso"><a href="#3-Run-CRSIPResso" class="headerlink" title="3: Run CRSIPResso"></a>3: Run CRSIPResso</h4><p>I applied the parameters used in <a href="https://www.nature.com/articles/s41467-018-05773-6" title="the original paper" target="_blank" rel="noopener">the original paper</a> to analyze the data with CRISPResso.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">crispresso \</span><br><span class="line">-r1 /Volumes/databank1/ngs/DRR147084_1.fastq.gz \</span><br><span class="line">-r2 /Volumes/databank1/ngs/DRR147084_2.fastq.gz \</span><br><span class="line">-a ttacatgatgcagaaagttgatatccctccgcttcttactctttttttttttctcccccatcatacaggtgaatatgaccatctcccagaacaggccttctatatggtgggacccattgaagaagctgtggcaaaagctgataagctggctgaagagcattcatcgtgaggggtctttgtcctctgtactgtctctctccttgcccctaacccaaaaagcttcatttttctgtgtaggctgcacaagagccttgattgaagatatattctttctgaacagtatttaaggtttccaataaaatgtacacccctcagaatttgtctgattctcttggtt \</span><br><span class="line">-g tgaagagcattcatcgtgag \</span><br><span class="line">-e ttacatgatgcagaaagttgatatccctccgcttcttactctttttttttttctcccccatcatacaggtgaatatgaccatctcccagaacaggccttctatatggtgggacccattgaagaagctgtggcaaaagctgataagctggctgaagagcattcatcgtggGGATCCGACTATAAGGACCACGACGGAGACTACAAGGATCATGATATTGATTACAAAGACGATGACGATAAGTAAgaggggtctttgtcctctgtactgtctctctccttgcccctaacccaaaaagcttcatttttctgtgtaggctgcacaagagccttgattgaagatatattctttctgaacagtatttaaggtttccaataaaatgtacacccctcagaatttgtctgattctcttggtt \</span><br><span class="line">-d ggGGATCCGACTATAAGGACCACGACGGAGACTACAAGGATCATGATATTGATTACAAAGACGATGACGATAAGTAA \</span><br><span class="line">-o /Volumes/databank1/ngs \</span><br><span class="line">--name crispresso_example1 \</span><br><span class="line">--hide_mutations_outside_window_NHEJ \</span><br><span class="line">--hdr_perfect_alignment_threshold 99.5;</span><br></pre></td></tr></table></figure><p><code>-o</code> indicates OUTPUT_FOLDER (“/Volumes/databank1/ngs”). You can choose it freely.<br>The explanation of the other parameter is shown in <a href="https://github.com/lucapinello/CRISPResso" title="author&#39;s github" target="_blank" rel="noopener">author’s github</a></p><p>The result files is saved into OUTPUT_FOLDER/“crispresso_example1” folder.</p><p>The full explanation of output is described in <a href="https://www.nature.com/articles/nbt.3583" title="the author&#39;s paper" target="_blank" rel="noopener">the author’s paper</a>.<br>I pick up some results.</p><p>2.Unmodified_NHEJ_HDR_pie_chart.pdf<br><img src="/images/2019-11-14_5.png" alt="2.Unmodified_NHEJ_HDR_pie_chart.pdf" title="2.Unmodified_NHEJ_HDR_pie_chart.pdf"><br>My understanding is that “Unmodified”, “NHEJ”, “Mixed HDR-NHEJ”, and “HDR” are wildtype amplicon sequence, indel amplicon sequence, unexpected knock-in sequence (may be generated by NHEJ), and expected knock-in amplicon sequence generated by MMEJ.<br>The mutation rate is 10.8 + 37.1 + 14.3 = 62.2%.<br>For your information, the value of Cas-Analyzer and CrispRVariants was 61.0% and 61.4%, respectively, according to the following posts.</p><ul><li><a href="https://kazukinakamae.github.io/2019/11/07/how-to-analyze-CRISPR-Cas9-sample-CasAnalyzer/" title="How to analyze CRISPR-Cas9 NGS sample using Cas-Analyzer">How to analyze CRISPR-Cas9 NGS sample using Cas-Analyzer</a>.</li><li><a href="https://kazukinakamae.github.io/2019/11/07/how-to-map-CRISPR-Cas9-sample-CrispRVariants/" title="How to analyze CRISPR-Cas9 sample using CrispRVariants">How to analyze CRISPR-Cas9 sample using CrispRVariants</a>.</li></ul><p>9.Alleles_around_cut_site_for_<guide>.pdf<br><img src="/images/2019-11-14_6.png" alt="9.Alleles_around_cut_site_for_&lt;guide&gt;.pdf" title="9.Alleles_around_cut_site_for_&lt;guide&gt;.pdf"></guide></p><p>Quantification_of_editing_frequency.txt<br><img src="/images/2019-11-14_7.png" alt="Quantification_of_editing_frequency.txt" title="Quantification_of_editing_frequency.txt"></p><p>You can see the list of reads using Excel. </p><p>Alleles_frequency_table.txt<br><img src="/images/2019-11-14_8.png" alt="Alleles_frequency_table.txt" title="Alleles_frequency_table.txt"></p><h4 id="Supplementary-Run-CRSIPResso-with-TruSeq3-PE-fa"><a href="#Supplementary-Run-CRSIPResso-with-TruSeq3-PE-fa" class="headerlink" title="(Supplementary): Run CRSIPResso with TruSeq3-PE.fa"></a>(Supplementary): Run CRSIPResso with TruSeq3-PE.fa</h4><p>CRISPResso contains Trimmomatic to adapter trimming and quality filtering.<br>As I mentioned in <a href="https://kazukinakamae.github.io/2019/10/28/How-to-trim-adapters-using-Trimmomatic/" title="tha past post">tha past post</a>, <a href="https://github.com/timflutre/trimmomatic/blob/master/adapters/TruSeq3-PE.fa" title="TruSeq3-PE.fa" target="_blank" rel="noopener">TruSeq3-PE.fa</a> is used in the MiSeq machine which performed sequencing the example data. Trimmomatic privides the adapter sequence data.</p><p>I typed the previous CRISPResso command with the TruSeq3-PE.fa to get results with a more correct way.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">crispresso \</span><br><span class="line">-r1 /Volumes/databank1/ngs/DRR147084_1.fastq.gz \</span><br><span class="line">-r2 /Volumes/databank1/ngs/DRR147084_2.fastq.gz \</span><br><span class="line">-a ttacatgatgcagaaagttgatatccctccgcttcttactctttttttttttctcccccatcatacaggtgaatatgaccatctcccagaacaggccttctatatggtgggacccattgaagaagctgtggcaaaagctgataagctggctgaagagcattcatcgtgaggggtctttgtcctctgtactgtctctctccttgcccctaacccaaaaagcttcatttttctgtgtaggctgcacaagagccttgattgaagatatattctttctgaacagtatttaaggtttccaataaaatgtacacccctcagaatttgtctgattctcttggtt \</span><br><span class="line">-g tgaagagcattcatcgtgag \</span><br><span class="line">-e ttacatgatgcagaaagttgatatccctccgcttcttactctttttttttttctcccccatcatacaggtgaatatgaccatctcccagaacaggccttctatatggtgggacccattgaagaagctgtggcaaaagctgataagctggctgaagagcattcatcgtggGGATCCGACTATAAGGACCACGACGGAGACTACAAGGATCATGATATTGATTACAAAGACGATGACGATAAGTAAgaggggtctttgtcctctgtactgtctctctccttgcccctaacccaaaaagcttcatttttctgtgtaggctgcacaagagccttgattgaagatatattctttctgaacagtatttaaggtttccaataaaatgtacacccctcagaatttgtctgattctcttggtt \</span><br><span class="line">-d ggGGATCCGACTATAAGGACCACGACGGAGACTACAAGGATCATGATATTGATTACAAAGACGATGACGATAAGTAA \</span><br><span class="line">-o /Volumes/databank1/ngs \</span><br><span class="line">--name crispresso_example2 \</span><br><span class="line">--hide_mutations_outside_window_NHEJ \</span><br><span class="line">--hdr_perfect_alignment_threshold 99.5 \</span><br><span class="line">--trim_sequences \</span><br><span class="line">--trimmomatic_options_string <span class="string">" ILLUMINACLIP:/Volumes/databank1/ngs/trimmomatic/adapters/TruSeq3-PE.fa:0:90:10:0:true MINLEN:40"</span>;</span><br></pre></td></tr></table></figure><p>You have to remenber adding “:2:30:10 MINLEN:36” to the end of adapter sequence file path. The explanetion of “:2:30:10 MINLEN:36” is shown in <a href="http://www.usadellab.org/cms/uploads/supplementary/Trimmomatic/TrimmomaticManual_V0.32.pdf" title="the Trimmomatic manual" target="_blank" rel="noopener">the Trimmomatic manual</a>. If you understand what it says, you can adjust the value.</p><p>The dropped sequences were only 5 reads.<br><img src="/images/2019-11-14_4.png" alt="Trimmomatic log in CRISPResso_RUNNING_LOG.txt" title="Trimmomatic log in CRISPResso_RUNNING_LOG.txt"></p><p><img src="/images/2019-11-14_9.png" alt="2.Unmodified_NHEJ_HDR_pie_chart.png" title="2.Unmodified_NHEJ_HDR_pie_chart.png"></p><p>The classification result was almost same as the data without adapter trimming. In some published reports, the trimming was not practiced in CRISPResso. However, the impact might be not large (I do NOT mean that it is not necessary to trim adapters…).</p><p>Thank you so much…</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;Hi sir,&lt;br&gt;I feel like eating &lt;a href=&quot;https://en.wikipedia.org/wiki/Citrus_unshiu&quot; title=&quot;satsuma&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;satsum
      
    
    </summary>
    
    
      <category term="NGS Analysis" scheme="https://KazukiNakamae.github.io/categories/NGS-Analysis/"/>
    
    
      <category term="Bioinformatics" scheme="https://KazukiNakamae.github.io/tags/Bioinformatics/"/>
    
      <category term="Anaconda" scheme="https://KazukiNakamae.github.io/tags/Anaconda/"/>
    
      <category term="CRISPResso" scheme="https://KazukiNakamae.github.io/tags/CRISPResso/"/>
    
  </entry>
  
  <entry>
    <title>How to analyze CRISPR-Cas9 NGS sample using Cas-Analyzer</title>
    <link href="https://KazukiNakamae.github.io/2019/11/07/how-to-analyze-CRISPR-Cas9-sample-CasAnalyzer/"/>
    <id>https://KazukiNakamae.github.io/2019/11/07/how-to-analyze-CRISPR-Cas9-sample-CasAnalyzer/</id>
    <published>2019-11-07T06:18:13.000Z</published>
    <updated>2019-12-15T09:45:21.838Z</updated>
    
    <content type="html"><![CDATA[<p>Hi sir,<br>I have a headache. I took <a href="https://en.wikipedia.org/wiki/Pocari_Sweat" title="Pocari Sweat" target="_blank" rel="noopener">Pocari Sweat</a> and the medicine. I wish to be better…</p><p>Anyway, today, I introduce <a href="http://www.rgenome.net/cas-analyzer/#!" title="Cas-analyzer" target="_blank" rel="noopener">Cas-analyzer</a> which is a web-based NGS analysis tool. This is specialized for analyzing knock-out/knock-in data generated with CRISPR.</p><p>Citation info: <a href="https://doi.org/10.1093/bioinformatics/btw561" title="Cas-Analyzer" target="_blank" rel="noopener">Park J. et al. Cas-Analyzer: an online tool for assessing genome editing results using NGS data. Bioinformatics 33, 286-288 (2017)</a>.</p><p>I use the published filtered NGS amplicon data (qfltr_DRR147084_1.fastq / qfltr_DRR147084_2.fastq) which was generated in the step 6 of <a href="https://kazukinakamae.github.io/2019/10/27/How-to-map-NGS-data-using-BWAMEM/" title="How to map NGS data using BWA-MEM">the post</a></p><p>The data is a knock-in sample of ATP5B locus in a human cell according to <a href="https://www.nature.com/articles/s41467-018-05773-6" title="How to map NGS data using BWA-MEM" target="_blank" rel="noopener">the paper</a>. You can see the sequence infromation in the “Methods” block.</p><p>We show the analysis example. Please watch the following video.</p><div class="video-container"><iframe src="//www.youtube.com/embed/wB4OUgbtvnc" frameborder="0" allowfullscreen></iframe></div><p>Donor sequence is optional parameter. If you analize knock-out data, the information is not required.</p><p>As I showed the result in this video, the indel frequency is 61.0%. CrispRVariants showed that mutation efficiency of the same sample was 61.37% in <a href="https://kazukinakamae.github.io/2019/11/07/how-to-map-CRISPR-Cas9-sample-CrispRVariants/" title="pastpost">the past post</a>.<br>I feel that the algorithm of Cas-Analyzer is quite simple, but it is effective.</p><p>Thank you so much…</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;Hi sir,&lt;br&gt;I have a headache. I took &lt;a href=&quot;https://en.wikipedia.org/wiki/Pocari_Sweat&quot; title=&quot;Pocari Sweat&quot; target=&quot;_blank&quot; rel=&quot;noope
      
    
    </summary>
    
    
      <category term="NGS Analysis" scheme="https://KazukiNakamae.github.io/categories/NGS-Analysis/"/>
    
    
      <category term="Bioinformatics" scheme="https://KazukiNakamae.github.io/tags/Bioinformatics/"/>
    
      <category term="Cas-Analyzer" scheme="https://KazukiNakamae.github.io/tags/Cas-Analyzer/"/>
    
  </entry>
  
  <entry>
    <title>How to analyze CRISPR-Cas9 sample using CrispRVariants</title>
    <link href="https://KazukiNakamae.github.io/2019/11/07/how-to-map-CRISPR-Cas9-sample-CrispRVariants/"/>
    <id>https://KazukiNakamae.github.io/2019/11/07/how-to-map-CRISPR-Cas9-sample-CrispRVariants/</id>
    <published>2019-11-06T16:20:57.000Z</published>
    <updated>2019-12-15T09:44:27.435Z</updated>
    
    <content type="html"><![CDATA[<p>Hi sir,<br>Winter is comming. I am thinking about setting <a href="https://en.wikipedia.org/wiki/Kotatsu" title="kotatsu" target="_blank" rel="noopener">kotatsu</a>.</p><p>Today, I introduce how to analyze CRISPR-Cas9 sample using <a href="https://bioconductor.org/packages/release/bioc/html/CrispRVariants.html" title="CrispRVariants" target="_blank" rel="noopener">CrispRVariants</a>. which is a accurate NGS analysis tool. This is specialized for analyzing genome editing data.</p><p>Citation info: <a href="https://www.nature.com/nbt/journal/v34/n7/full/nbt.3628.html" title="CrispRVariants" target="_blank" rel="noopener">Lindsay, Helen, et al. “CrispRVariants charts the mutation spectrum of genome engineering experiments.” Nature biotechnology 34.7 (2016): 701.</a>.</p><p>In previous posts, I introduced <a href="https://kazukinakamae.github.io/2019/10/27/How-to-map-NGS-data-using-BWAMEM/" title="how to map NGS data using BWA-MEM">how to map NGS data using BWA-MEM</a>. I will use this bam file to introduce it. If you have not seen it, you can check <a href="https://kazukinakamae.github.io/2019/10/27/How-to-map-NGS-data-using-BWAMEM/" title="how to map NGS data using BWA-MEM">the post</a> before.</p><p>I will show an alignment map of the region indicated as the following “focusing_range” in the wildtype amplicon sequence.</p><p><img src="/images/2019-11-6_1.png" alt="Whole sequence of amplicon" title="Whole sequence of amplicon"><br><img src="/images/2019-11-6_2.png" alt="Focusing range" title="focusing range"></p><p>OK, I will put a simple example…</p><h3 id="STEP1-Searching-the-region-of-“focusing-range”-using-Blat"><a href="#STEP1-Searching-the-region-of-“focusing-range”-using-Blat" class="headerlink" title="STEP1: Searching the region of “focusing_range” using Blat"></a>STEP1: Searching the region of “focusing_range” using Blat</h3><h4 id="1-Create-visual-environment"><a href="#1-Create-visual-environment" class="headerlink" title="1: Create visual environment"></a>1: Create visual environment</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda create --name blat_env --channel bioconda blat;</span><br></pre></td></tr></table></figure><h4 id="2-Activate-visual-environment"><a href="#2-Activate-visual-environment" class="headerlink" title="2: Activate visual environment"></a>2: Activate visual environment</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">source</span> activate blat_env;</span><br></pre></td></tr></table></figure><h4 id="3-Make-this-fasta-file-as-focusing-range-fa"><a href="#3-Make-this-fasta-file-as-focusing-range-fa" class="headerlink" title="3: Make this fasta file as focusing_range.fa"></a>3: Make this fasta file as focusing_range.fa</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;focusing_range</span><br><span class="line">gtggcaaaagctgataagctggctgaagagcattcatcgtgaggggtctttgtcctctgtactgtctctctccttgcccc</span><br></pre></td></tr></table></figure><p>The above sequence is saved as <code>focusing_range.fa</code> into <code>/Volumes/databank1/ngs/</code>.</p><h4 id="4-Searching-the-region-of-“focusing-range”-using-Blat"><a href="#4-Searching-the-region-of-“focusing-range”-using-Blat" class="headerlink" title="4: Searching the region of “focusing_range” using Blat"></a>4: Searching the region of “focusing_range” using Blat</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">blat /Volumes/databank1/ngs/hg38.fa /Volumes/databank1/ngs/focusing_range.fa -minMatch=0 -minScore=80 /Volumes/databank1/ngs/focusing_range.fa.psl;</span><br></pre></td></tr></table></figure><p>The parameter of <code>-minScore</code> is to be the sequence length of focusing_range.fa</p><p>When the below sequence is shown, the process is end. <code>focusing_range.fa.psl</code> is automatically Saved in <code>/Volumes/databank1/ngs/</code>.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Loaded 3088269832 letters in 24 sequences</span><br><span class="line">Searched 80 bases in 1 sequences</span><br></pre></td></tr></table></figure><h4 id="5-Make-tsv-file-to-open-the-result-of-blat-focusing-range-fa-psl"><a href="#5-Make-tsv-file-to-open-the-result-of-blat-focusing-range-fa-psl" class="headerlink" title="5: Make tsv file to open the result of blat (focusing_range.fa.psl)"></a>5: Make tsv file to open the result of blat (focusing_range.fa.psl)</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp /Volumes/databank1/ngs/focusing_range.fa.psl /Volumes/databank1/ngs/focusing_range.fa.psl.tsv;</span><br></pre></td></tr></table></figure><p>Open /Volumes/databank1/ngs/focusing_range.fa.psl.tsv using Excel or the other spreadsheet.<br>You have to memorilize the value of highlighted cells (strand : - / T name : chr12 / T start : 56638284 / T end : 56638364)</p><p><img src="/images/2019-11-6_3.png" alt="Result of Blat" title="Result of Blat"></p><h3 id="STEP2-Install-CrispRVariants-using-RStudio"><a href="#STEP2-Install-CrispRVariants-using-RStudio" class="headerlink" title="STEP2: Install CrispRVariants using RStudio."></a>STEP2: Install CrispRVariants using RStudio.</h3><p>CrispRVariants sometimes fails to be installed now (at 2019/11/07). Especially, Anaconda version is unstable. I hope that it will be improved.<br>Anyway, to install CrispRVariants, you can do the following procedure in video. It is important to type <code>no</code> when the RStudio asked you <code>Do you want to install from sources the packages which need compilation? (Yes/no/cancel)</code>.</p><div class="video-container"><iframe src="//www.youtube.com/embed/n0K8tPFsJRA" frameborder="0" allowfullscreen></iframe></div><h3 id="STEP3-Analyzing-CRISPR-Cas9-sample-using-CrispRVariants"><a href="#STEP3-Analyzing-CRISPR-Cas9-sample-using-CrispRVariants" class="headerlink" title="STEP3: Analyzing CRISPR-Cas9 sample using CrispRVariants"></a>STEP3: Analyzing CRISPR-Cas9 sample using CrispRVariants</h3><p>Open the RStudio.app, and type the following script. </p><h4 id="6-Install-and-load-packages"><a href="#6-Install-and-load-packages" class="headerlink" title="6: Install and load packages"></a>6: Install and load packages</h4><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (!requireNamespace(<span class="string">"BiocManager"</span>, quietly = <span class="literal">TRUE</span>))</span><br><span class="line">  install.packages(<span class="string">"BiocManager"</span>)</span><br><span class="line"></span><br><span class="line">BiocManager::install(<span class="string">"CrispRVariants"</span>)</span><br><span class="line">BiocManager::install(<span class="string">"GenomicRanges"</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">library</span>(<span class="string">"CrispRVariants"</span>)</span><br><span class="line"><span class="keyword">library</span>(<span class="string">"GenomicRanges"</span>)</span><br></pre></td></tr></table></figure><h4 id="7-Name-the-analysis"><a href="#7-Name-the-analysis" class="headerlink" title="7: Name the analysis"></a>7: Name the analysis</h4><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Name of this analysis (Free)</span></span><br><span class="line">dataname.char &lt;- <span class="string">"my NGS data"</span></span><br></pre></td></tr></table></figure><h4 id="8-Enter-the-file-path-of-the-bam-file-generated-using-BWA-MEM"><a href="#8-Enter-the-file-path-of-the-bam-file-generated-using-BWA-MEM" class="headerlink" title="8: Enter the file path of the bam file generated using BWA-MEM"></a>8: Enter the file path of the bam file generated using BWA-MEM</h4><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Place of your bam file</span></span><br><span class="line">bam.file.path &lt;- <span class="string">"/Volumes/databank1/ngs/out.extendedFrags.fastq.bam"</span></span><br></pre></td></tr></table></figure><h4 id="9-Enter-the-sequence-of-focusing-range"><a href="#9-Enter-the-sequence-of-focusing-range" class="headerlink" title="9: Enter the sequence of focusing_range"></a>9: Enter the sequence of focusing_range</h4><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Nuclease target site (This is protospacer sequence in CRISPR-Cas9.)</span></span><br><span class="line">focusing.sequence.char &lt;- <span class="string">"gtggcaaaagctgataagctggctgaagagcattcatcgtgaggggtctttgtcctctgtactgtctctctccttgcccc"</span></span><br></pre></td></tr></table></figure><h4 id="10-Enter-the-position-of-cut-point-in-focusing-range"><a href="#10-Enter-the-position-of-cut-point-in-focusing-range" class="headerlink" title="10: Enter the position of cut point in focusing_range"></a>10: Enter the position of cut point in focusing_range</h4><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Cut point in the focusing range (5'-&gt;3')</span></span><br><span class="line">target.location &lt;- <span class="number">40</span></span><br></pre></td></tr></table></figure><h4 id="11-Enter-the-range-where-you-consider-a-mismatch-base-as-Single-Nucleotide-Variants"><a href="#11-Enter-the-range-where-you-consider-a-mismatch-base-as-Single-Nucleotide-Variants" class="headerlink" title="11: Enter the range where you consider a mismatch base as Single Nucleotide Variants"></a>11: Enter the range where you consider a mismatch base as Single Nucleotide Variants</h4><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># How long region (upstream (5'side from the cut site) / downstream (3'side from the cut site)) do you consider as Single Nucleotide Variants?</span></span><br><span class="line">upstream.snv.num &lt;- <span class="number">17</span></span><br><span class="line">downstream.snv.num &lt;- <span class="number">6</span></span><br></pre></td></tr></table></figure><h4 id="12-Enter-the-flag-whether-you-can-treat-chimera-sequence"><a href="#12-Enter-the-flag-whether-you-can-treat-chimera-sequence" class="headerlink" title="12: Enter the flag whether you can treat chimera sequence."></a>12: Enter the flag whether you can treat chimera sequence.</h4><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Flag to determine how chimeric reads are treated. One of "ignore", "exclude",and "merge".</span></span><br><span class="line"><span class="comment"># I reccomend to use "ignore" in first time.</span></span><br><span class="line">treat.chimeras &lt;- <span class="string">"ignore"</span></span><br></pre></td></tr></table></figure><p>The function recognizing a chimeric sequence is outstanding advantage of CrispRVarinats.<br>However, I recommend to ignore that in the first time because recognizing a chimeric sequence cause the loss of detected reads.</p><h4 id="13-Enter-the-information-of-focusing-range-fa-psl"><a href="#13-Enter-the-information-of-focusing-range-fa-psl" class="headerlink" title="13: Enter the information of focusing_range.fa.psl"></a>13: Enter the information of focusing_range.fa.psl</h4><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">blat.strand &lt;- <span class="string">"-"</span></span><br><span class="line">blat.T.name &lt;- <span class="string">"chr12"</span></span><br><span class="line">blat.T.start &lt;- <span class="number">56638284</span></span><br><span class="line">blat.T.end &lt;- <span class="number">56638364</span></span><br></pre></td></tr></table></figure><h4 id="14-Create-the-GRange-object-of-focusing-range-sequence"><a href="#14-Create-the-GRange-object-of-focusing-range-sequence" class="headerlink" title="14: Create the GRange object of focusing_range sequence"></a>14: Create the GRange object of focusing_range sequence</h4><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">focusing.grange = GRanges(blat.T.name, blat.strand, ranges = IRanges(blat.T.start + <span class="number">1</span>, blat.T.end))</span><br></pre></td></tr></table></figure><p>There is a difference between GRange and range of the Blat result. I adjusted it by adding <code>+ 1</code> to <code>blat.T.start</code>.</p><h4 id="15-Create-crispr-set-object"><a href="#15-Create-crispr-set-object" class="headerlink" title="15: Create crispr set object"></a>15: Create crispr set object</h4><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">crispr.set &lt;- readsToTarget(bam.file.path</span><br><span class="line">, focusing.grange, reference = focusing.sequence.char</span><br><span class="line">, target.loc = target.location</span><br><span class="line">, names = dataname.char</span><br><span class="line">, upstream.snv = upstream.snv.num</span><br><span class="line">, downstream.snv = downstream.snv.num </span><br><span class="line">, chimeras = treat.chimeras)</span><br></pre></td></tr></table></figure><p>output</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Read 158666 alignments, excluded 0</span><br><span class="line"></span><br><span class="line">147559 of 158666 nonchimeric reads span the target range</span><br><span class="line"></span><br><span class="line">narrowing alignments</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Initialising CrisprRun my NGS data</span><br><span class="line"></span><br><span class="line">Initialising CrisprSet chr12:56638285-56638364 with 1 samples</span><br></pre></td></tr></table></figure><h4 id="16-Create-alignment-map"><a href="#16-Create-alignment-map" class="headerlink" title="16: Create alignment map"></a>16: Create alignment map</h4><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">plotVariants(crispr.set)</span><br></pre></td></tr></table></figure><p><img src="/images/2019-11-6_4.png" alt="Alignment map" title="Alignment map"></p><h4 id="17-Estimate-the-editing-efficiency"><a href="#17-Estimate-the-editing-efficiency" class="headerlink" title="17: Estimate the editing efficiency"></a>17: Estimate the editing efficiency</h4><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mutationEfficiency(crispr.set)</span><br></pre></td></tr></table></figure><p>output</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">my NGS data     Average      Median     Overall       StDev   ReadCount </span><br><span class="line">      61.37       61.37       61.37       61.37          NA   147559.00</span><br></pre></td></tr></table></figure><p>The editing efficiency is 61.37%. SNV is not counted into the efficiency.<br>In this sample, there is only one sample type. So, The “Average” is same as “my NGS data”.</p><h4 id="18-Show-the-consensus-sequences-of-variant-alleles"><a href="#18-Show-the-consensus-sequences-of-variant-alleles" class="headerlink" title="18: Show the consensus sequences of variant alleles"></a>18: Show the consensus sequences of variant alleles</h4><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">consensusSeqs(crispr.set)</span><br></pre></td></tr></table></figure><p>output</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">  A DNAStringSet instance of length 629</span><br><span class="line">      width seq                                                                               names               </span><br><span class="line">  [1]    80 GGGGCAAGGAGAGAGACAGTACAGAGGACAAAGACCCCTCACGATGAATGCTCTTCAGCCAGCTTATCAGCTTTTGCCAC  no variant</span><br><span class="line">  [2]    80 GGGGCAAGGAGAGAGACAGTACAGAGGACAAAGACCCCTCACGATGAATGCCCTTCAGCCAGCTTATCAGCTTTTGCCAC  SNV:-12G</span><br><span class="line">  [3]    80 GGGGCAAGGAGAGAGACAGTACAGAGGACAAAGACCCCTCACGAGGAATGCTCTTCAGCCAGCTTATCAGCTTTTGCCAC  SNV:-5C</span><br><span class="line">  [4]    80 GGGGCAAGGAGAGAGACAGTACAGAGGACAAAGACCCCTAACGATGAATGCTCTTCAGCCAGCTTATCAGCTTTTGCCAC  SNV:1T</span><br><span class="line">  [5]    80 GGGGCAAGGAGAGAGACAGTACAGAGGACAAAGACCCCTCACGATGAAGGCTCTTCAGCCAGCTTATCAGCTTTTGCCAC  SNV:-9C</span><br><span class="line">  ...   ... ...</span><br><span class="line">[625]   123 GGGGCAAGGAGAGAGACAGTACAGAGGACAAAGACCCCT...CGATGAATGCTCTTCAGCCCGCTTATCAGCTTTTGCCAC -1:43I</span><br><span class="line">[626]   136 GGGGCAAGGAGAGAGACAGTACAGAGGACAAAGACACAT...CGATGAATGCTCTTCTGCCAGCTTATCAGCTTTTGCCAC 2:1D,6:57I</span><br><span class="line">[627]   123 GGGGCAAGGAGAGAGACAGTACAGAGGACAAAGACCCCG...CGATGAATGCTCTTCAGCCAGCTTATCAGCTTTTGCCAC 3:43I</span><br><span class="line">[628]   175 GGGGCAAGGAGAGAGACAGTACAGCAGACAAAGACCCCT...CAGCTTATCAGCTTTAGCCAGATTATCATCTTTTGCCAC -30:18I,1:77I</span><br><span class="line">[629]    80 GGGGCAAGGAGAGAGACAGTACAGAGGACAAGACCCCTCAACGATGAATGCTCTTCAGCCAGCTTATCAGCTTTTGCCAC  1:1I,11:1D</span><br></pre></td></tr></table></figure><p>You can save the full sequence infromation using the following command</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">write.csv(as.data.frame(consensusSeqs(crispr.set)), file.path(<span class="string">"/Volumes/databank1/ngs/"</span>, <span class="string">"consensus.seqs.csv"</span>))</span><br></pre></td></tr></table></figure><h4 id="19-Show-the-count-data-of-variant-alleles"><a href="#19-Show-the-count-data-of-variant-alleles" class="headerlink" title="19: Show the count data of variant alleles"></a>19: Show the count data of variant alleles</h4><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">variantCounts(crispr.set)</span><br></pre></td></tr></table></figure><p>output</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">                           my NGS data</span><br><span class="line">no variant                       55017</span><br><span class="line">SNV:-12G                           136</span><br><span class="line">SNV:-5C                            104</span><br><span class="line">SNV:1T                              86</span><br><span class="line">SNV:-9C                             69</span><br><span class="line">SNV:-17G                            65</span><br><span class="line">...</span><br><span class="line">1:1I                             44667</span><br><span class="line">2:77I                            26772</span><br><span class="line">-1:1D                             1491</span><br><span class="line">-10:13D                           1417</span><br><span class="line">1:7D                               892</span><br><span class="line">...</span><br><span class="line">-1:43I                               1</span><br><span class="line">2:1D,6:57I                           1</span><br><span class="line">3:43I                                1</span><br><span class="line">-30:18I,1:77I                        1</span><br><span class="line">1:1I,11:1D                           1</span><br></pre></td></tr></table></figure><p>You can save the full variants infromation using the following command</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">write.csv(as.data.frame(variantCounts(crispr.set)), file.path(<span class="string">"/Volumes/databank1/ngs/"</span>, <span class="string">"variantcounts.csv"</span>))</span><br></pre></td></tr></table></figure><h4 id="20-Create-barplot-of-variants-classification-by-size"><a href="#20-Create-barplot-of-variants-classification-by-size" class="headerlink" title="20: Create barplot of variants classification by size"></a>20: Create barplot of variants classification by size</h4><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">barplotAlleleFreqs(variantCounts(crispr.set))</span><br></pre></td></tr></table></figure><p><img src="/images/2019-11-6_5.png" alt="Alignment map" title="Alignment map"></p><p>This is a simple example. You can change the procedure.</p><h5 id="Environment"><a href="#Environment" class="headerlink" title="Environment"></a>Environment</h5><p>Hardware</p><ul><li>MacBook Air (2017 model)</li><li>Processor 1.8 GHz Intel Core i5</li><li>Memory 8GB</li><li>500 GB external hard drive</li></ul><p>Software</p><ul><li>macOS Catalina</li><li>GNU bash version : 3.2.57(1)-release (x86_64-apple-darwin18)</li></ul><p>Anaconda</p><ul><li>conda version : 4.7.11</li><li>conda-build version : 3.17.6</li><li>python version : 2.7.15.final.0</li><li>Standalone BLAT v. 36</li></ul><p>RStudio</p><ul><li>R version 3.6.1 (2019-07-05)</li><li>Platform: x86_64-apple-darwin15.6.0 (64-bit)</li><li>RStudio Version 1.2.5019</li></ul><p>Thank you so much…</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;Hi sir,&lt;br&gt;Winter is comming. I am thinking about setting &lt;a href=&quot;https://en.wikipedia.org/wiki/Kotatsu&quot; title=&quot;kotatsu&quot; target=&quot;_blank&quot;
      
    
    </summary>
    
    
      <category term="NGS Analysis" scheme="https://KazukiNakamae.github.io/categories/NGS-Analysis/"/>
    
    
      <category term="Bioinformatics" scheme="https://KazukiNakamae.github.io/tags/Bioinformatics/"/>
    
      <category term="Anaconda" scheme="https://KazukiNakamae.github.io/tags/Anaconda/"/>
    
      <category term="RStudio" scheme="https://KazukiNakamae.github.io/tags/RStudio/"/>
    
      <category term="CrispRVariants" scheme="https://KazukiNakamae.github.io/tags/CrispRVariants/"/>
    
  </entry>
  
  <entry>
    <title>How to trim adapters using Trimmomatic</title>
    <link href="https://KazukiNakamae.github.io/2019/10/28/How-to-trim-adapters-using-Trimmomatic/"/>
    <id>https://KazukiNakamae.github.io/2019/10/28/How-to-trim-adapters-using-Trimmomatic/</id>
    <published>2019-10-28T11:13:39.000Z</published>
    <updated>2019-12-15T09:45:01.104Z</updated>
    
    <content type="html"><![CDATA[<p>Hi sir,<br>How are you?</p><p>Today, I introduce how to trim adapters using Trimmomatic.</p><p>Citation info: <a href="https://academic.oup.com/bioinformatics/article/30/15/2114/2390096" title="Trimmomatic" target="_blank" rel="noopener">Bolger, A. M., Lohse, M., &amp; Usadel, B. (2014). Trimmomatic: A flexible trimmer for Illumina Sequence Data. Bioinformatics, btu170.</a></p><p>Honestly, I cannot force you to do it because we can map NGS data without trimming adapters.</p><p>But, <a href="https://www.ecseq.com/support/ngs/trimming-adapter-sequences-is-it-necessary" title="Trimming adapter sequences - is it necessary?" target="_blank" rel="noopener">this article</a> and <a href="https://www.biostars.org/p/212136/" title="Forum: Trimming adapter sequences - is it necessary?" target="_blank" rel="noopener">discussion in Biosters</a> are interesting. Let see it.</p><p>Anyway, I will put a simple example of trimming adapters using Trimmomatic and the published amplicon sequencing data.</p><h3 id="STEP1-Creating-a-visual-environment"><a href="#STEP1-Creating-a-visual-environment" class="headerlink" title="STEP1: Creating a visual environment"></a>STEP1: Creating a visual environment</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">conda create --name trimmomatic_env;</span><br><span class="line"><span class="built_in">source</span> activate trimmomatic_env;</span><br><span class="line"></span><br><span class="line">conda config --add channels bioconda;</span><br><span class="line">conda install --channel bioconda sra-tools trimmomatic;</span><br><span class="line">conda config --remove channels bioconda;</span><br></pre></td></tr></table></figure><h3 id="STEP2-Downloading-the-example-data"><a href="#STEP2-Downloading-the-example-data" class="headerlink" title="STEP2: Downloading the example data."></a>STEP2: Downloading the example data.</h3><p>*In this example, I use published amplicon sequence data. If you have your FASTQ files, skip this section.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fastq-dump DRR147084 --split-files --gzip --outdir /Volumes/databank1/ngs; <span class="comment"># Download from SRR(DRR)</span></span><br></pre></td></tr></table></figure><h3 id="STEP3-Preparing-the-adapter-sequences"><a href="#STEP3-Preparing-the-adapter-sequences" class="headerlink" title="STEP3: Preparing the adapter sequences"></a>STEP3: Preparing the adapter sequences</h3><p>You have to get FASTA sequences of adapters to use Trimmomatic. Please check the <a href="http://www.usadellab.org/cms/?page=trimmomatic" title="USADELLAB.org" target="_blank" rel="noopener">Authors Page</a>.<br>According to that, <a href="https://github.com/timflutre/trimmomatic/blob/master/adapters/TruSeq3-PE.fa" title="TruSeq3-PE.fa" target="_blank" rel="noopener">TruSeq3-PE.fa</a> is used in the MiSeq machine which performed sequencing the example data.</p><p>Download the Trimmomatic data from <a href="https://github.com/timflutre/trimmomatic/tree/master/adapters" title="trimmomatic/adapters/" target="_blank" rel="noopener">GitHub</a>.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/timflutre/trimmomatic /Volumes/databank1/ngs/trimmomatic;</span><br></pre></td></tr></table></figure><p>“TruSeq3-PE.fa” exists in <code>/Volumes/databank1/ngs/trimmomatic/adapters/</code>.</p><h3 id="STEP4-Executing-Trimmomatic-to-trim-the-adapters"><a href="#STEP4-Executing-Trimmomatic-to-trim-the-adapters" class="headerlink" title="STEP4: Executing Trimmomatic to trim the adapters"></a>STEP4: Executing Trimmomatic to trim the adapters</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">trimmomatic PE -phred33 \</span><br><span class="line">-trimlog log.txt /Volumes/databank1/ngs/DRR147084_1.fastq.gz /Volumes/databank1/ngs/DRR147084_2.fastq.gz \</span><br><span class="line">/Volumes/databank1/ngs/paired_DRR147084_1.fq /Volumes/databank1/ngs/unpaired_DRR147084_1.fq \</span><br><span class="line">/Volumes/databank1/ngs/paired_DRR147084_2.fq /Volumes/databank1/ngs/unpaired_DRR147084_2.fq \</span><br><span class="line">ILLUMINACLIP:/Volumes/databank1/ngs/trimmomatic/adapters/TruSeq3-PE.fa:2:30:10 \</span><br><span class="line">LEADING:20 TRAILING:20 SLIDINGWINDOW:4:15 MINLEN:36;</span><br></pre></td></tr></table></figure><p>“paired_DRR147084_1.fq”, “paired_DRR147084_2.fq” are the trimmed FASTQ files.</p><p>Thank you so much…</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;Hi sir,&lt;br&gt;How are you?&lt;/p&gt;
&lt;p&gt;Today, I introduce how to trim adapters using Trimmomatic.&lt;/p&gt;
&lt;p&gt;Citation info: &lt;a href=&quot;https://academic
      
    
    </summary>
    
    
      <category term="NGS Analysis" scheme="https://KazukiNakamae.github.io/categories/NGS-Analysis/"/>
    
    
      <category term="Bioinformatics" scheme="https://KazukiNakamae.github.io/tags/Bioinformatics/"/>
    
      <category term="Anaconda" scheme="https://KazukiNakamae.github.io/tags/Anaconda/"/>
    
      <category term="SRA" scheme="https://KazukiNakamae.github.io/tags/SRA/"/>
    
      <category term="Trimmomatic" scheme="https://KazukiNakamae.github.io/tags/Trimmomatic/"/>
    
  </entry>
  
  <entry>
    <title>How to map NGS data using BWA-MEM</title>
    <link href="https://KazukiNakamae.github.io/2019/10/27/How-to-map-NGS-data-using-BWAMEM/"/>
    <id>https://KazukiNakamae.github.io/2019/10/27/How-to-map-NGS-data-using-BWAMEM/</id>
    <published>2019-10-27T06:24:22.000Z</published>
    <updated>2019-12-15T09:44:44.482Z</updated>
    
    <content type="html"><![CDATA[<p>Hi sir,<br>It is definetly autumn. I recommend to visit <a href="https://matcha-jp.com/en/5124" title="Miyajima" target="_blank" rel="noopener">Miyajima</a> and try “Momiji Manju”.<br><img src="https://resources.matcha-jp.com/resize/720x2000/2019/08/05-83019.jpeg" alt="Miyajima (cited from MATCHA)" title="Cited from MATCHA"></p><p>Today, I introduce how to map NGS data using BWA-MEM.</p><p><a href="http://bio-bwa.sourceforge.net" title="BWAMEM aligner" target="_blank" rel="noopener">BWAMEM aligner</a> is one of the most famous tools in NGS analysis. Some tool requires data processed using BWA-MEM (It is difficult for beginners…).</p><p>I would like to suggest that you buy &gt;20GB external hard drive/SSD/USB flash drive before you try the following analysis because NGS analysis manages numerous amounts of data. I usually 500 GB external hard drive to save NGS-associated data (saving directory: <code>/Volumes/databank1/ngs</code>). I don’t use my internal storage, it’s for Steam.</p><p>We introduce it, step by step. If you want to see the only mapping step, scroll down to “STEP4”.</p><h3 id="STEP1-Creating-a-visual-environment"><a href="#STEP1-Creating-a-visual-environment" class="headerlink" title="STEP1: Creating a visual environment"></a>STEP1: Creating a visual environment</h3><h4 id="1-Create-visual-environment"><a href="#1-Create-visual-environment" class="headerlink" title="1: Create visual environment"></a>1: Create visual environment</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda create --name bwa_env;</span><br></pre></td></tr></table></figure><p>*If you cannot use <code>conda</code> command in your terminal, please visit <a href="https://kazukinakamae.github.io/2019/10/26/How-to-install-Anaconda/" title="How to install Anaconda">How to install Anaconda</a>.</p><h4 id="2-Activate-the-visual-environment"><a href="#2-Activate-the-visual-environment" class="headerlink" title="2: Activate the visual environment"></a>2: Activate the visual environment</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">source</span> activate bwa_env;</span><br></pre></td></tr></table></figure><h4 id="3-Add-packages-into-the-visual-environment"><a href="#3-Add-packages-into-the-visual-environment" class="headerlink" title="3: Add packages into the visual environment"></a>3: Add packages into the visual environment</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">conda config --add channels bioconda; <span class="comment"># add channel</span></span><br><span class="line">conda install --channel bioconda sra-tools sickle-trim flash bwa samtools; <span class="comment"># install packages from the channel</span></span><br><span class="line">conda config --remove channels bioconda; <span class="comment"># remove the channel</span></span><br></pre></td></tr></table></figure><h3 id="STEP2-Preparing-FASTQ-file"><a href="#STEP2-Preparing-FASTQ-file" class="headerlink" title="STEP2: Preparing FASTQ file"></a>STEP2: Preparing FASTQ file</h3><p>*In this example, I use published amplicon sequence data. If you have the filtered &amp; merged FASTQ files, skip this section.</p><h4 id="4-Download-compressed-FASTQ-files"><a href="#4-Download-compressed-FASTQ-files" class="headerlink" title="4: Download compressed FASTQ files"></a>4: Download compressed FASTQ files</h4><p><a href="https://trace.ncbi.nlm.nih.gov/Traces/sra/?run=DRR147084" title="DRR147084" target="_blank" rel="noopener">Information Page of DRR147084 in SRA (DRR database)</a><br>You don’t have to access the site when you download it. Type the following command.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fastq-dump DRR147084 --split-files --gzip --outdir /Volumes/databank1/ngs; <span class="comment"># Download from SRR(DRR)</span></span><br></pre></td></tr></table></figure><h4 id="5-Wait-for-a-minute-until-you-can-type-a-command-in-your-terminal-again"><a href="#5-Wait-for-a-minute-until-you-can-type-a-command-in-your-terminal-again" class="headerlink" title="5: Wait for a minute until you can type a command in your terminal again"></a>5: Wait for a minute until you can type a command in your terminal again</h4><p>*You can kill time by reading <a href="https://www.nature.com/articles/s41467-018-05773-6" title="paper" target="_blank" rel="noopener">this paper</a> which is the original report using the downloading deep sequencing data.</p><h4 id="6-Filter-the-raw-NGS-files-using-sickle"><a href="#6-Filter-the-raw-NGS-files-using-sickle" class="headerlink" title="6: Filter the raw NGS files using sickle"></a>6: Filter the raw NGS files using sickle</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sickle pe -f /Volumes/databank1/ngs/DRR147084_1.fastq.gz -r /Volumes/databank1/ngs/DRR147084_2.fastq.gz -t sanger \</span><br><span class="line">-o /Volumes/databank1/ngs/qfltr_DRR147084_1.fastq -p /Volumes/databank1/ngs/qfltr_DRR147084_2.fastq \</span><br><span class="line">-s /Volumes/databank1/ngs/single_DRR147084.fastq; <span class="comment"># Trim average quality &lt;\Q20 and read length &lt; 20bp</span></span><br></pre></td></tr></table></figure><p>*<code>qfltr_DRR147084_1.fastq</code>, <code>qfltr_DRR147084_2.fastq</code>, <code>single_DRR147084.fastq</code> are my choice. You can name it freely.<br>*Do you want to trim adapters before that? You can check <a href="https://kazukinakamae.github.io/2019/10/28/How-to-trim-adapters-using-Trimmomatic/" title="How to trim adapters using Trimmomatic">the article</a>.</p><h4 id="7-Merge-paired-end-reads-using-FLASh"><a href="#7-Merge-paired-end-reads-using-FLASh" class="headerlink" title="7: Merge paired-end reads using FLASh"></a>7: Merge paired-end reads using FLASh</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /Volumes/databank1/ngs/;flash /Volumes/databank1/ngs/qfltr_DRR147084_1.fastq /Volumes/databank1/ngs/qfltr_DRR147084_2.fastq;<span class="built_in">cd</span> ~/Desktop;</span><br></pre></td></tr></table></figure><p>The merged file “out.extendedFrags.fastq” is saved into <code>/Volumes/databank1/ngs/</code> when the process is done.</p><h3 id="STEP3-Generate-the-fasta-file-index-of-the-human-reference-genome-version-38"><a href="#STEP3-Generate-the-fasta-file-index-of-the-human-reference-genome-version-38" class="headerlink" title="STEP3: Generate the fasta file index of the human reference genome (version 38)"></a>STEP3: Generate the fasta file index of the human reference genome (version 38)</h3><p>*If you got the NGS data from the other organism, you have to try it using reference genome of that. <a href="http://hgdownload.cse.ucsc.edu/downloads.html" title="UCSC" target="_blank" rel="noopener">This site</a> will be helpful to find the genome you want.</p><h4 id="8-Download-compressed-files-of-the-human-reference-genome-version-38"><a href="#8-Download-compressed-files-of-the-human-reference-genome-version-38" class="headerlink" title="8: Download compressed files of the human reference genome (version 38)"></a>8: Download compressed files of the human reference genome (version 38)</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget http://hgdownload.cse.ucsc.edu/goldenPath/hg38/bigZips/analysisSet/hg38.analysisSet.chroms.tar.gz --directory-prefix /Volumes/databank1/ngs/;</span><br></pre></td></tr></table></figure><h4 id="9-Unpack-the-files"><a href="#9-Unpack-the-files" class="headerlink" title="9: Unpack the files"></a>9: Unpack the files</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /Volumes/databank1/ngs/;</span><br><span class="line">gunzip -c /Volumes/databank1/ngs/hg38.analysisSet.chroms.tar.gz | tar xopf -;</span><br><span class="line"><span class="built_in">cd</span> ~/Desktop;</span><br></pre></td></tr></table></figure><h4 id="10-Conbine-files-into-hg38-fa"><a href="#10-Conbine-files-into-hg38-fa" class="headerlink" title="10: Conbine files into hg38.fa"></a>10: Conbine files into hg38.fa</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> `seq 1 22` X Y;<span class="keyword">do</span> cat /Volumes/databank1/ngs/hg38.analysisSet.chroms/chr<span class="variable">$i</span>.fa &gt;&gt; /Volumes/databank1/ngs/hg38.fa;<span class="keyword">done</span>;</span><br></pre></td></tr></table></figure><h4 id="11-Delete-immediate-files-to-save-storage"><a href="#11-Delete-immediate-files-to-save-storage" class="headerlink" title="11: Delete immediate files to save storage"></a>11: Delete immediate files to save storage</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rm -rf /Volumes/databank1/ngs/hg38.analysisSet.chroms/;</span><br></pre></td></tr></table></figure><h4 id="12-Generate-the-fasta-file-index-of-hg38"><a href="#12-Generate-the-fasta-file-index-of-hg38" class="headerlink" title="12: Generate the fasta file index of hg38"></a>12: Generate the fasta file index of hg38</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bwa index -p /Volumes/databank1/ngs/hg38 /Volumes/databank1/ngs/hg38.fa;</span><br></pre></td></tr></table></figure><h4 id="13-Wait-for-about-20-30-minutes-until-you-can-type-a-command-in-your-terminal-again"><a href="#13-Wait-for-about-20-30-minutes-until-you-can-type-a-command-in-your-terminal-again" class="headerlink" title="13: Wait for about 20-30 minutes until you can type a command in your terminal again"></a>13: Wait for about 20-30 minutes until you can type a command in your terminal again</h4><p>It is a long time. You can take a nap and browse the shops.</p><h3 id="STEP4-Mapping-the-merged-FASTQ-file-using-human-reference-genome-hg38"><a href="#STEP4-Mapping-the-merged-FASTQ-file-using-human-reference-genome-hg38" class="headerlink" title="STEP4: Mapping the merged FASTQ file using human reference genome (hg38)"></a>STEP4: Mapping the merged FASTQ file using human reference genome (hg38)</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bwa mem -t 1 /Volumes/databank1/ngs/hg38 /Volumes/databank1/ngs/out.extendedFrags.fastq | samtools sort -o /Volumes/databank1/ngs/out.extendedFrags.fastq.bam;</span><br></pre></td></tr></table></figure><p>*<code>/Volumes/databank1/ngs/hg38</code> indicates the name of the reference index.</p><p>The mapped bam file “out.extendedFrags.fastq.bam” is saved into <code>/Volumes/databank1/ngs/</code> when the process is done.<br>I guess that you can use it for some analysis.</p><h3 id="Option-View-the-mapped-bam-file-using-Integrative-Genomics-Viewer-IGV"><a href="#Option-View-the-mapped-bam-file-using-Integrative-Genomics-Viewer-IGV" class="headerlink" title="(Option): View the mapped bam file using Integrative Genomics Viewer (IGV)"></a>(Option): View the mapped bam file using Integrative Genomics Viewer (IGV)</h3><h4 id="14-make-index-of-mapped-file"><a href="#14-make-index-of-mapped-file" class="headerlink" title="14: make index of mapped file."></a>14: make index of mapped file.</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">samtools index /Volumes/databank1/ngs/out.extendedFrags.fastq.bam;</span><br></pre></td></tr></table></figure><h4 id="15-Download-IGV"><a href="#15-Download-IGV" class="headerlink" title="15: Download IGV"></a>15: Download IGV</h4><p><a href="https://software.broadinstitute.org/software/igv/download" title="Download Page" target="_blank" rel="noopener">Download Page</a></p><p><img src="/images/2019-10-27_1.png" alt="Download Page For IGV"></p><h4 id="16-Install-application"><a href="#16-Install-application" class="headerlink" title="16: Install application"></a>16: Install application</h4><p>When I finished the download, the application “IGV_2.7.2.app” has been already installed in the Download directory.</p><h4 id="17-Start-IGV-2-7-2-app"><a href="#17-Start-IGV-2-7-2-app" class="headerlink" title="17: Start IGV_2.7.2.app"></a>17: Start IGV_2.7.2.app</h4><h4 id="18-Click-“Genomes”-gt-”Load-Genome-File…”"><a href="#18-Click-“Genomes”-gt-”Load-Genome-File…”" class="headerlink" title="18: Click “Genomes”&gt;”Load Genome File…”"></a>18: Click “Genomes”&gt;”Load Genome File…”</h4><h4 id="19-Select-“-Volumes-databank1-ngs-hg38-fa”"><a href="#19-Select-“-Volumes-databank1-ngs-hg38-fa”" class="headerlink" title="19: Select “/Volumes/databank1/ngs/hg38.fa”"></a>19: Select “/Volumes/databank1/ngs/hg38.fa”</h4><h4 id="20-Click-“File”-gt-“Load-from-File…”"><a href="#20-Click-“File”-gt-“Load-from-File…”" class="headerlink" title="20: Click “File” &gt; “Load from File…”"></a>20: Click “File” &gt; “Load from File…”</h4><h4 id="21-Select-Volumes-databank1-ngs-out-extendedFrags-fastq-bam"><a href="#21-Select-Volumes-databank1-ngs-out-extendedFrags-fastq-bam" class="headerlink" title="21: Select /Volumes/databank1/ngs/out.extendedFrags.fastq.bam"></a>21: Select /Volumes/databank1/ngs/out.extendedFrags.fastq.bam</h4><h4 id="22-Enter-the-genome-region-of-the-amplicon-sequence-in-the-search-form"><a href="#22-Enter-the-genome-region-of-the-amplicon-sequence-in-the-search-form" class="headerlink" title="22: Enter the genome region of the amplicon sequence in the search form"></a>22: Enter the genome region of the amplicon sequence in the search form</h4><p>*The “DRR147084” is amplicon sequence data of ATP5B MMEJ-assisted knock-in sample. The gene region of ATP5B is “chr12:56,638,302-56,638,353”</p><p><img src="/images/2019-10-27_2.png" alt="amplicon sequence data in IGV"></p><p>*You can check the region using <a href="https://genome-asia.ucsc.edu/cgi-bin/hgTracks?db=hg38&lastVirtModeType=default&lastVirtModeExtraState=&virtModeType=default&virtMode=0&nonVirtPosition=&position=chr12%3A56638175%2D56645279&hgsid=729668905_tDpmuTzz6AxKqxPykn5I4ebXPh6r" title="genome browser" target="_blank" rel="noopener">genome browser</a>.</p><p>This is a simple example. You can change the procedure because there is no royal road to NGS analysis (fortunately or unfortunately, I don’t know…).</p><p>Additionally, you can get the following variant calling if you use specific tools such as <a href="https://bioconductor.org/packages/release/bioc/vignettes/CrispRVariants/inst/doc/user_guide.pdf" title="CrispRVariants" target="_blank" rel="noopener">CrispRVariants</a>.</p><p><img src="/images/2019-11-6_4.png" alt="amplicon sequence data in CrispRVariants"></p><h5 id="Environement"><a href="#Environement" class="headerlink" title="Environement"></a>Environement</h5><p>Hardware</p><ul><li>MacBook Air (2017 model)</li><li>Processor 1.8 GHz Intel Core i5</li><li>Memory 8GB</li><li>500 GB external hard drive</li></ul><p>Software</p><ul><li>macOS Mojave</li><li>GNU bash version : 3.2.57(1)-release (x86_64-apple-darwin18)</li><li>conda version : 4.7.11</li><li>conda-build version : 3.17.6</li><li>python version : 2.7.15.final.0</li></ul><p>Thank you so much…</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;Hi sir,&lt;br&gt;It is definetly autumn. I recommend to visit &lt;a href=&quot;https://matcha-jp.com/en/5124&quot; title=&quot;Miyajima&quot; target=&quot;_blank&quot; rel=&quot;noo
      
    
    </summary>
    
    
      <category term="NGS Analysis" scheme="https://KazukiNakamae.github.io/categories/NGS-Analysis/"/>
    
    
      <category term="Bioinformatics" scheme="https://KazukiNakamae.github.io/tags/Bioinformatics/"/>
    
      <category term="Anaconda" scheme="https://KazukiNakamae.github.io/tags/Anaconda/"/>
    
      <category term="SRA" scheme="https://KazukiNakamae.github.io/tags/SRA/"/>
    
      <category term="Sickle" scheme="https://KazukiNakamae.github.io/tags/Sickle/"/>
    
      <category term="FLASh" scheme="https://KazukiNakamae.github.io/tags/FLASh/"/>
    
      <category term="BWA-MEM" scheme="https://KazukiNakamae.github.io/tags/BWA-MEM/"/>
    
  </entry>
  
  <entry>
    <title>How to install Anaconda</title>
    <link href="https://KazukiNakamae.github.io/2019/10/26/How-to-install-Anaconda/"/>
    <id>https://KazukiNakamae.github.io/2019/10/26/How-to-install-Anaconda/</id>
    <published>2019-10-26T08:42:18.000Z</published>
    <updated>2019-12-15T09:45:45.291Z</updated>
    
    <content type="html"><![CDATA[<p>Hi sir,</p><p>Today, I introduce how to install Anaconda. What is Anaconda? You can see <a href="https://en.wikipedia.org/wiki/Anaconda_(Python_distribution)" title="Wikipedia" target="_blank" rel="noopener">Wikipedia</a>.</p><p>I am planning to use it in many reports because Anaconda can create a virtual environment.</p><p>The virtual environment could avoid conflictions of the local environment (It is so important).</p><p>Anyway, we simply introduce it.</p><p>1: Go to the <a href="https://www.anaconda.com/distribution/" title="Anaconda_Distribution" target="_blank" rel="noopener">Anaconda_Distribution</a>.</p><p>2: Scroll down until you find the below button.</p><p><img src="/images/2019-10-26_1.png" alt="Download Page For Installer"></p><p>3: Push “Download” button (Either is good. I can recommend installing 3.7 version).</p><p>4: Lunch the downloaded file. It is an installer of Anaconda.</p><p>5: Follow the instruction of the installer. When it asking you something, click “Continue” or “Agree”.</p><p>6: Lastly, click “Close”</p><p>It is done.</p><p>You can also check whether it was installed correctly.</p><p>(For Mac)</p><p>6: Open “Terminal.app” in “Applications” Folder (I call “Folder” “Directory” also…).</p><p>7: Type “conda”.</p><p>8: Push the “Enter” button.</p><p>If you can see the long description that starts in “usage [-h] [-V] command …”, it is OK. Congratulations!!!</p><p>If not, omg…, you can browse another website to collect the information.<br>Of course, when you ask the question in the comment form, I will support it as long as I can.</p><p>Thank you so much…</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;Hi sir,&lt;/p&gt;
&lt;p&gt;Today, I introduce how to install Anaconda. What is Anaconda? You can see &lt;a href=&quot;https://en.wikipedia.org/wiki/Anaconda_
      
    
    </summary>
    
    
      <category term="Installation" scheme="https://KazukiNakamae.github.io/categories/Installation/"/>
    
    
      <category term="Bioinformatics" scheme="https://KazukiNakamae.github.io/tags/Bioinformatics/"/>
    
  </entry>
  
  <entry>
    <title>Launched</title>
    <link href="https://KazukiNakamae.github.io/2019/10/25/Launched/"/>
    <id>https://KazukiNakamae.github.io/2019/10/25/Launched/</id>
    <published>2019-10-25T08:01:20.000Z</published>
    <updated>2019-10-26T08:54:53.778Z</updated>
    
    <content type="html"><![CDATA[<p>Hi sir,</p><p>I opened “n|nja” just now. this website will upload reports of bioinformatics tools (mainly, about genome editing) and my hobby.</p><p>Thank you so much…</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;Hi sir,&lt;/p&gt;
&lt;p&gt;I opened “n|nja” just now. this website will upload reports of bioinformatics tools (mainly, about genome editing) and my 
      
    
    </summary>
    
    
      <category term="others" scheme="https://KazukiNakamae.github.io/categories/others/"/>
    
    
      <category term="report" scheme="https://KazukiNakamae.github.io/tags/report/"/>
    
  </entry>
  
</feed>
